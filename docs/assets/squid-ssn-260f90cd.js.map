{"version":3,"file":"squid-ssn-260f90cd.js","sources":["../../dist/squid-ssn/squid-ssn.js"],"sourcesContent":["import { css, html } from 'lit';\nimport { SquidInput } from '../squid-input/squid-input.js';\nimport { defineSquidElement } from '../utils/defineSquidElement.js';\nimport { emitEvent } from '../utils/squidEvents.js';\n\nvar css_248z = css`.toggle-button{background:none;border:0;color:#0e307a;cursor:pointer;font-size:.875rem}.toggle-button:hover{filter:brightness(80%) saturate(80%)}`;\n\n/**\n * @tag squid-ssn\n * @summary `SquidSsn` is an implementation of [`SquidInput`](../squid-input) that serves as a social-security number mask for privacy reasons.\n * @prop {String} value - value of the input.\n * @event squid-change - The input value has changed.\n * @example <squid-ssn>Social security number</squid-ssn>\n */\nclass SquidSsn extends SquidInput {\n    constructor() {\n        super();\n        this.bindMethod('_parseAddtion');\n        this.bindMethod('_parseDeletion');\n        this.bindMethod('__onKeydown');\n        this.bindMethod('_addMask');\n        this.bindMethod('_unmask');\n        this.bindMethod('_manageCursor');\n        this.bindMethod('__showHideToggle');\n        this.bindMethod('__onBlur');\n        this.bindMethod('__onFocus');\n        this._isDelete = false;\n        this.unmaskedValue = '';\n        this.maskedValue = '';\n        this._obfuscatedValue = '';\n    }\n\n    static get styles() {\n        return [...super.styles,css_248z];\n    }\n    /** Get the value from the value attribute */\n    // get value() {\n    get value() {\n        return this._value;\n    }\n    //     return this._value;\n    // }\n\n    // /** When the value changes, make sure the emit events and set up masks */\n    // set value(_value) {\n    //     const value = this._unmask(_value.toString());\n    //     emitEvent('squid-change', _value,this);\n    //     const input = this.__getInput();\n    //     if(input){\n    //         this._mask(value);\n    //     }\n    // }\n    updated(changedProperties){\n        if (changedProperties.has('value')) {\n            const value = this._unmask(this.value.toString());\n            emitEvent('squid-change', this.value,this);\n            this._mask(value);\n        }\n    }\n    render(){\n        return html`\n        <div id=\"container\" data-ref=\"wrapper\">\n            <div class=\"label-wrapper\">\n                <label class=\"textfield__label\" for=\"squid-input-${this._uid}\" data-ref=\"label\"><slot></slot>${this._showDisabled}</label>\n                <button class='toggle-button' data-ref='toggleButton' @click=${this.__showHideToggle}>Hide</button>\n            </div>\n            <input class=\"textfield__input\" \n                    type=\"${this._inputType}\" \n                    name=\"${this.name?this.name:''}\"\n                    value=\"${this.value}\" \n                    id=\"squid-input-${this._uid}\" \n                    data-ref=\"input\"\n                    ?disabled=${this.disabled}\n                    ?required=${this.required}\n                    ?readonly=${this.readonly}\n                    ?autofocus=${this.autofocus}\n                    ?compact=${this.compact}\n                    @keydown=${this.__onKeydown}\n                    @input=${this.__onInput}\n                    @blur=${this.__onBlur}\n                    @focus=${this.__onFocus}\n                    maxlength=\"${this.maxlength?this.maxlength:''}\"\n                    max=\"${this.max?this.max:''}\"\n                    minlength=\"${this.minlength?this.minlength:''}\"\n                    min=\"${this.min?this.min:''}\"\n                    placeholder=\"${this.placeholder?this.placeholder:''}\"\n                    autocomplete=\"${this.autocomplete?this.autocomplete:''}\"\n                     \n                    aria-describedby=\" helpers-${this._uid} counter-${this._uid}\"\n                    class=\"\">\n            <squid-helpers id=\"helpers-${this._uid}\" data-ref=\"helpers\"></squid-helpers>\n        </div>\n        `;\n    }\n    firstUpdated(){\n        super.connectedCallback();\n        this.hasValidation = true;\n        this.maskState = 'hidden';\n        this._placeholder = '___-__-____';\n        // this.pattern = \"^\\d{3}-\\d{2}-\\d{4}$\";\n        this.minlength = 11;\n        this.maxlength = 11;\n        this._toggleButtonText();\n    }\n    /**\n     * Manage the location of the cursor\n     * @param {String} maskedValue the masked value\n     * @param {number} selectionStart the current cursor location\n     * @param {Event} event keyboard Event\n     */\n    _manageCursor(maskedValue, selectionStart, evt={}) {\n        if (selectionStart >= 3 && selectionStart < 5) {\n            selectionStart += 1;\n        } else if (selectionStart >= 5) {\n            selectionStart += 2;\n        }\n    \n        if (evt.inputType === 'deleteContentBackward') {\n            selectionStart = this._cachedSelection - 1;\n        }\n    \n        this.__getInput().setSelectionRange(selectionStart, selectionStart);\n    }\n    /**\n     * Handel the blur event to add placeholder back in.\n     * \n     */\n    __onBlur(){\n        const input  = this.__getInput();\n        if (input.value === this._placeholder) {\n            input.value = '';\n        }\n        this.checkValidity();\n    }\n\n    __onFocus(){\n        setTimeout(() => {\n            const input  = this.__getInput();\n            if (input.value === '') {\n                input.setSelectionRange(0, 0);\n            } else {\n                const firstPlaceholder = input.value.indexOf('_');\n                input.setSelectionRange(firstPlaceholder, firstPlaceholder);\n            }\n        });\n    }\n    /**\n     * Handel the input event\n     * @param {Event} evt input event\n     */\n    __onInput(evt){\n        console.log('on input');\n        if(!evt.inputType && this._isDelete){\n            evt.inputType = 'deleteContentBackward';\n        }\n        if(evt.inputType !== 'deleteContentBackward'){\n            this._parseAddtion(evt);\n        } else {\n            this._parseDeletion(evt);\n        }\n    }\n    /**\n     * Handels the keydown event\n     * @param {Event} evt handel keydown event\n     */\n    __onKeydown(evt){\n        const deleteKeys = [8,64];\n        const { key } = evt;\n        const input = this.__getInput();\n        const { selectionStart } = input;\n        this._isDelete = deleteKeys.includes(evt.keyCode);\n        this._cachedValue = this.unmaskedValue || '';\n        this._cachedSelection = selectionStart;\n        if(key.match(/[0-9]$/)){\n            input.value = '';\n        } else {\n            if(key.toString().includes('Arrow')) {\n                setTimeout(()=>{\n                    this._cachedSelection = input.selectionStart;\n                });\n            }\n        }\n    }\n    /**\n     * Handel the paste event\n     * @param {Event} evt Paste Event\n     */\n    __onPaste(evt){\n        const pastedValue = evt.clipboardData.getData('text/plain');\n        this._mask(pastedValue);\n    }\n    /**\n     * adding to the mask   \n     * @param {Event} evt keyboard Event passed\n     */\n    _parseAddtion(evt){\n        const oldValue = this._addMask(this._cachedValue);\n        const newValue = this._unmask(oldValue.slice(0,this._cachedSelection) + this.__getInput().value + oldValue.slice(this._cachedSelection));\n        this._mask(newValue,evt);\n    }\n    /**\n     * deleting to the mask\n     * @param {Event} evt keyboard Event passed\n     */\n    _parseDeletion(evt){\n        const maskedValue = this._addMask(this._cachedValue);\n        const value = this._unmask(`${maskedValue.slice(0,this._cachedSelection -1)}${maskedValue.slice(this._cachedSelection)}`);\n        this._mask(value,evt);\n    }\n\n    /**\n     * Mask the value of the SSN\n     * @param {String} value value to add a mask to\n     */\n    _addMask(value=''){\n        const placeholderCharacter = '_';\n        const unmaskedValue = this._unmask(value);\n        const firstThree = unmaskedValue.slice(0, 3).padEnd(3, placeholderCharacter);\n        const secondTwo = unmaskedValue.slice(3, 5).padEnd(2, placeholderCharacter);\n        const lastFour = unmaskedValue.slice(5, 9).padEnd(4, placeholderCharacter);\n\n        let maskedValue = '';\n        if(firstThree.length === 3){\n            maskedValue += `${firstThree}-`;\n        } else {\n            maskedValue += firstThree;\n        }\n        if(secondTwo.length === 2){\n            maskedValue += `${secondTwo}-`;\n        } else {\n            maskedValue += secondTwo;\n        }\n\n        maskedValue += lastFour;\n\n        this.maskedValue = maskedValue;\n        return maskedValue;\n    }\n    /**\n     * Unmask the input value\n     * @param {String} value the Masked value\n     */\n    _unmask(value=''){\n        return value.replace(/\\D/g, '').slice(0, 9);\n    }\n\n    /**\n     * Mask the value to not be seen\n     * @param {String} value value to be masked\n     * @param {Event} evt keyboard event\n     */\n    async _mask(value='', evt={}) {\n        const unmaskedValue = this._unmask(value);\n        const maskedValue = this._addMask(unmaskedValue);\n        const isDelete = evt.inputType === 'deleteContentBackward';\n        this.unmaskedValue = unmaskedValue;\n        this.maskedValue = maskedValue;\n    \n        const obfuscateValue = await this._obfuscate(maskedValue);\n        const start = isDelete ?  this._cachedSelection : unmaskedValue.length;\n        this._manageCursor(obfuscateValue, start, evt);\n        this._isDelete = undefined;\n    }\n\n    /**\n     * Obfuscate the input value\n     * @param {String} value value to obfucate\n     */\n    _obfuscate(value=''){\n        return new Promise(resolve => {\n            const input  = this.__getInput();\n            let obfuscatedValue = value.slice(0, 7).replace(/[0-9]/g, 'â€¢') + value.slice(7, 12);\n            this._obfuscatedValue = obfuscatedValue;\n            this._value = this.unmaskedValue.slice(0, 9);\n            if (this.maskState === 'visible') {\n                input.value = value;\n            } else {\n                input.value = this._obfuscatedValue;\n            }\n            resolve(this.maskedValue);\n        });\n    }\n    /**\n     * toggle the text to show or hide ssn\n     */\n    _toggleButtonText(){\n        const toggleButton = this.renderRoot.querySelector('button');\n        if (this.maskState === 'hidden') {\n            toggleButton.innerHTML = 'Show';\n        } else if (this.maskState === 'visible') {\n            toggleButton.innerHTML = 'Hide';\n        }\n    }\n    /**\n     * toggle the value of input from hidden to showing the value\n     */\n    __showHideToggle() {\n        const input = this.__getInput();\n        if (this.maskState === 'visible') {\n            this.maskState = 'hidden';\n            input.value = this._obfuscatedValue;\n        } else {\n            this.maskState = 'visible';\n            input.value = this.maskedValue;\n        }\n        this._toggleButtonText();\n    }\n    /**\n     * Overwrite the checkValidity to handel error messages\n     */\n    checkValidity() {\n        if (this._value.length < 9){\n            this.setCustomValidity('Please enter in a valid ssn');\n            return false;\n        } else {\n            this.setCustomValidity('');\n        }\n        return super.checkValidity();\n    }\n}\ndefineSquidElement('squid-ssn',SquidSsn);\n\nexport { SquidSsn };\n"],"names":["css_248z","css","SquidSsn","SquidInput","changedProperties","value","emitEvent","html","maskedValue","selectionStart","evt","input","firstPlaceholder","deleteKeys","key","pastedValue","oldValue","newValue","placeholderCharacter","unmaskedValue","firstThree","secondTwo","lastFour","isDelete","obfuscateValue","start","resolve","obfuscatedValue","toggleButton","defineSquidElement"],"mappings":"sMAKA,IAAIA,EAAWC,qJASf,MAAMC,UAAiBC,CAAW,CAC9B,aAAc,CACV,QACA,KAAK,WAAW,eAAe,EAC/B,KAAK,WAAW,gBAAgB,EAChC,KAAK,WAAW,aAAa,EAC7B,KAAK,WAAW,UAAU,EAC1B,KAAK,WAAW,SAAS,EACzB,KAAK,WAAW,eAAe,EAC/B,KAAK,WAAW,kBAAkB,EAClC,KAAK,WAAW,UAAU,EAC1B,KAAK,WAAW,WAAW,EAC3B,KAAK,UAAY,GACjB,KAAK,cAAgB,GACrB,KAAK,YAAc,GACnB,KAAK,iBAAmB,EAC3B,CAED,WAAW,QAAS,CAChB,MAAO,CAAC,GAAG,MAAM,OAAOH,CAAQ,CACnC,CAGD,IAAI,OAAQ,CACR,OAAO,KAAK,MACf,CAaD,QAAQI,EAAkB,CACtB,GAAIA,EAAkB,IAAI,OAAO,EAAG,CAChC,MAAMC,EAAQ,KAAK,QAAQ,KAAK,MAAM,SAAQ,CAAE,EAChDC,EAAU,eAAgB,KAAK,MAAM,IAAI,EACzC,KAAK,MAAMD,CAAK,EAEvB,CACD,QAAQ,CACJ,OAAOE;AAAAA;AAAAA;AAAAA,mEAGoD,KAAK,uCAAuC,KAAK;AAAA,+EACrC,KAAK;AAAA;AAAA;AAAA,4BAGxD,KAAK;AAAA,4BACL,KAAK,KAAK,KAAK,KAAK;AAAA,6BACnB,KAAK;AAAA,sCACI,KAAK;AAAA;AAAA,gCAEX,KAAK;AAAA,gCACL,KAAK;AAAA,gCACL,KAAK;AAAA,iCACJ,KAAK;AAAA,+BACP,KAAK;AAAA,+BACL,KAAK;AAAA,6BACP,KAAK;AAAA,4BACN,KAAK;AAAA,6BACJ,KAAK;AAAA,iCACD,KAAK,UAAU,KAAK,UAAU;AAAA,2BACpC,KAAK,IAAI,KAAK,IAAI;AAAA,iCACZ,KAAK,UAAU,KAAK,UAAU;AAAA,2BACpC,KAAK,IAAI,KAAK,IAAI;AAAA,mCACV,KAAK,YAAY,KAAK,YAAY;AAAA,oCACjC,KAAK,aAAa,KAAK,aAAa;AAAA;AAAA,iDAEvB,KAAK,gBAAgB,KAAK;AAAA;AAAA,yCAElC,KAAK;AAAA;AAAA,SAGzC,CACD,cAAc,CACV,MAAM,kBAAiB,EACvB,KAAK,cAAgB,GACrB,KAAK,UAAY,SACjB,KAAK,aAAe,cAEpB,KAAK,UAAY,GACjB,KAAK,UAAY,GACjB,KAAK,kBAAiB,CACzB,CAOD,cAAcC,EAAaC,EAAgBC,EAAI,CAAA,EAAI,CAC3CD,GAAkB,GAAKA,EAAiB,EACxCA,GAAkB,EACXA,GAAkB,IACzBA,GAAkB,GAGlBC,EAAI,YAAc,0BAClBD,EAAiB,KAAK,iBAAmB,GAG7C,KAAK,WAAY,EAAC,kBAAkBA,EAAgBA,CAAc,CACrE,CAKD,UAAU,CACN,MAAME,EAAS,KAAK,aAChBA,EAAM,QAAU,KAAK,eACrBA,EAAM,MAAQ,IAElB,KAAK,cAAa,CACrB,CAED,WAAW,CACP,WAAW,IAAM,CACb,MAAMA,EAAS,KAAK,aACpB,GAAIA,EAAM,QAAU,GAChBA,EAAM,kBAAkB,EAAG,CAAC,MACzB,CACH,MAAMC,EAAmBD,EAAM,MAAM,QAAQ,GAAG,EAChDA,EAAM,kBAAkBC,EAAkBA,CAAgB,EAE1E,CAAS,CACJ,CAKD,UAAUF,EAAI,CACV,QAAQ,IAAI,UAAU,EACnB,CAACA,EAAI,WAAa,KAAK,YACtBA,EAAI,UAAY,yBAEjBA,EAAI,YAAc,wBACjB,KAAK,cAAcA,CAAG,EAEtB,KAAK,eAAeA,CAAG,CAE9B,CAKD,YAAYA,EAAI,CACZ,MAAMG,EAAa,CAAC,EAAE,EAAE,EAClB,CAAE,IAAAC,CAAK,EAAGJ,EACVC,EAAQ,KAAK,aACb,CAAE,eAAAF,CAAgB,EAAGE,EAC3B,KAAK,UAAYE,EAAW,SAASH,EAAI,OAAO,EAChD,KAAK,aAAe,KAAK,eAAiB,GAC1C,KAAK,iBAAmBD,EACrBK,EAAI,MAAM,QAAQ,EACjBH,EAAM,MAAQ,GAEXG,EAAI,SAAQ,EAAG,SAAS,OAAO,GAC9B,WAAW,IAAI,CACX,KAAK,iBAAmBH,EAAM,cAClD,CAAiB,CAGZ,CAKD,UAAUD,EAAI,CACV,MAAMK,EAAcL,EAAI,cAAc,QAAQ,YAAY,EAC1D,KAAK,MAAMK,CAAW,CACzB,CAKD,cAAcL,EAAI,CACd,MAAMM,EAAW,KAAK,SAAS,KAAK,YAAY,EAC1CC,EAAW,KAAK,QAAQD,EAAS,MAAM,EAAE,KAAK,gBAAgB,EAAI,KAAK,WAAY,EAAC,MAAQA,EAAS,MAAM,KAAK,gBAAgB,CAAC,EACvI,KAAK,MAAMC,EAASP,CAAG,CAC1B,CAKD,eAAeA,EAAI,CACf,MAAMF,EAAc,KAAK,SAAS,KAAK,YAAY,EAC7CH,EAAQ,KAAK,QAAQ,GAAGG,EAAY,MAAM,EAAE,KAAK,iBAAkB,CAAC,IAAIA,EAAY,MAAM,KAAK,gBAAgB,GAAG,EACxH,KAAK,MAAMH,EAAMK,CAAG,CACvB,CAMD,SAASL,EAAM,GAAG,CACd,MAAMa,EAAuB,IACvBC,EAAgB,KAAK,QAAQd,CAAK,EAClCe,EAAaD,EAAc,MAAM,EAAG,CAAC,EAAE,OAAO,EAAGD,CAAoB,EACrEG,EAAYF,EAAc,MAAM,EAAG,CAAC,EAAE,OAAO,EAAGD,CAAoB,EACpEI,EAAWH,EAAc,MAAM,EAAG,CAAC,EAAE,OAAO,EAAGD,CAAoB,EAEzE,IAAIV,EAAc,GAClB,OAAGY,EAAW,SAAW,EACrBZ,GAAe,GAAGY,KAElBZ,GAAeY,EAEhBC,EAAU,SAAW,EACpBb,GAAe,GAAGa,KAElBb,GAAea,EAGnBb,GAAec,EAEf,KAAK,YAAcd,EACZA,CACV,CAKD,QAAQH,EAAM,GAAG,CACb,OAAOA,EAAM,QAAQ,MAAO,EAAE,EAAE,MAAM,EAAG,CAAC,CAC7C,CAOD,MAAM,MAAMA,EAAM,GAAIK,EAAI,CAAA,EAAI,CAC1B,MAAMS,EAAgB,KAAK,QAAQd,CAAK,EAClCG,EAAc,KAAK,SAASW,CAAa,EACzCI,EAAWb,EAAI,YAAc,wBACnC,KAAK,cAAgBS,EACrB,KAAK,YAAcX,EAEnB,MAAMgB,EAAiB,MAAM,KAAK,WAAWhB,CAAW,EAClDiB,EAAQF,EAAY,KAAK,iBAAmBJ,EAAc,OAChE,KAAK,cAAcK,EAAgBC,EAAOf,CAAG,EAC7C,KAAK,UAAY,MACpB,CAMD,WAAWL,EAAM,GAAG,CAChB,OAAO,IAAI,QAAQqB,GAAW,CAC1B,MAAMf,EAAS,KAAK,aACpB,IAAIgB,EAAkBtB,EAAM,MAAM,EAAG,CAAC,EAAE,QAAQ,SAAU,GAAG,EAAIA,EAAM,MAAM,EAAG,EAAE,EAClF,KAAK,iBAAmBsB,EACxB,KAAK,OAAS,KAAK,cAAc,MAAM,EAAG,CAAC,EACvC,KAAK,YAAc,UACnBhB,EAAM,MAAQN,EAEdM,EAAM,MAAQ,KAAK,iBAEvBe,EAAQ,KAAK,WAAW,CACpC,CAAS,CACJ,CAID,mBAAmB,CACf,MAAME,EAAe,KAAK,WAAW,cAAc,QAAQ,EACvD,KAAK,YAAc,SACnBA,EAAa,UAAY,OAClB,KAAK,YAAc,YAC1BA,EAAa,UAAY,OAEhC,CAID,kBAAmB,CACf,MAAMjB,EAAQ,KAAK,aACf,KAAK,YAAc,WACnB,KAAK,UAAY,SACjBA,EAAM,MAAQ,KAAK,mBAEnB,KAAK,UAAY,UACjBA,EAAM,MAAQ,KAAK,aAEvB,KAAK,kBAAiB,CACzB,CAID,eAAgB,CACZ,OAAI,KAAK,OAAO,OAAS,GACrB,KAAK,kBAAkB,6BAA6B,EAC7C,KAEP,KAAK,kBAAkB,EAAE,EAEtB,MAAM,gBAChB,CACL,CACAkB,EAAmB,YAAY3B,CAAQ"}