{"version":3,"file":"squid-credit-card.stories-c9f6c88f.js","sources":["../../dist/squid-credit-card/squid-credit-card.js"],"sourcesContent":["import { SquidSsn } from '../squid-ssn/squid-ssn.js';\nimport { defineSquidElement } from '../utils/defineSquidElement.js';\nimport { css } from 'lit';\n\nvar css_248z = css``;\n\n/**\n * @tag squid-credit-card\n * @summary `SquidCreditCard` is an implementation of [`SquidInput`](../squid-input) that serves as a credit-card number mask for privacy reasons.\n * @prop {String} value - value of the input.\n * @event squid-change - The input value has changed.\n * @example <form name=\"cc-number\" autocomplete=\"cc-number\"><squid-credit-card>Credit Card</squid-credit-card></form>\n */\nclass SquidCreditCard extends SquidSsn {\n    static get styles() {\n        return [...super.styles,css_248z];\n    }\n    static get properties() {\n        return {...super.properties};\n    }\n    constructor() {\n        super();\n        this.name = 'ccnumber';\n        this.autocomplete = 'cc-number';\n    }\n    \n    firstUpdated(){\n        super.firstUpdated();\n        this._placeholder = '****************';\n        this.minlength = 16;\n        this.maxlength = 16;\n        console.log(this.value);\n    }\n    /**\n     * Mask the value of the SSN\n     * @param {String} value value to add a mask to\n     */\n    _addMask(value=''){\n        const placeholderCharacter = '-';\n        const unmaskedValue = this._unmask(value);\n        const firstThree = unmaskedValue.slice(0, 16).padEnd(16, placeholderCharacter);\n        let maskedValue = '';\n        maskedValue += firstThree;\n        this.maskedValue = firstThree;\n        return maskedValue;\n    }\n    /**\n     * Unmask the input value\n     * @param {String} value the Masked value\n     */\n    _unmask(value=''){\n        return value.replace(/\\D/g, '').slice(0, 16);\n    }\n    /**\n     * Mask the value to not be seen\n     * @param {String} value value to be masked\n     * @param {Event} evt keyboard event\n     */\n    async _mask(value='', evt={}) {\n        const unmaskedValue = this._unmask(value);\n        const maskedValue = this._addMask(unmaskedValue);\n        const isDelete = evt.inputType === 'deleteContentBackward';\n        this.unmaskedValue = unmaskedValue;\n        this.maskedValue = maskedValue;\n    \n        const obfuscateValue = await this._obfuscate(maskedValue);\n        const start = isDelete ?  this._cachedSelection : unmaskedValue.length;\n        this._manageCursor(obfuscateValue, start, evt);\n        this._isDelete = undefined;\n    }\n    /**\n     * Manage the location of the cursor\n     * @param {String} maskedValue the masked value\n     * @param {number} selectionStart the current cursor location\n     * @param {Event} event keyboard Event\n     */\n    _manageCursor(maskedValue, selectionStart, evt={}) {\n    \n        if (evt.inputType === 'deleteContentBackward') {\n            selectionStart = this._cachedSelection - 1;\n        }\n    \n        this.__getInput().setSelectionRange(selectionStart, selectionStart);\n    }\n    /**\n     * Obfuscate the input value\n     * @param {String} value value to obfucate\n     */\n    _obfuscate(value=''){\n        return new Promise(resolve => {\n            const input  = this.__getInput();\n            let obfuscatedValue = value.slice(0, 12).replace(/[0-9]/g, 'â€¢') + value.slice(12, 16);\n            this._obfuscatedValue = obfuscatedValue;\n            this._value = this.unmaskedValue.slice(0, 16);\n            if (this.maskState === 'visible') {\n                input.value = value;\n            } else {\n                input.value = this._obfuscatedValue;\n            }\n            resolve(this.maskedValue);\n        });\n    }\n    /**\n     * Overwrite the checkValidity to handel error messages\n     */\n    checkValidity() {\n        console.log(this.internals.form);\n        if (!this._value ||this._value.length < 16 || !this.luhnCheck(this._value)){\n            this.setCustomValidity('Please enter in a valid credit card number');\n            return false;\n        } else {\n            this.setCustomValidity('');\n        }\n        return super.checkValidity();\n    }\n    /**\n     * This is a luhn algorithm  or modulus 10 to check if it is a valid cc number\n     * @param {Number} number credit card number to check the luhn alg\n     * @returns Boolean\n     */\n    luhnCheck(number){\n        let nCheck = 0;\n        number = number.replace(/\\D/g,'');\n        number.split('').forEach((item, n) => {\n            let nDigit = parseInt(item, 10);\n            if (!(n % 2) && (nDigit *= 2) > 9) nDigit -= 9;\n            nCheck += nDigit;\n        });\n        return (nCheck % 10) === 0;\n    }\n    \n}\ndefineSquidElement('squid-credit-card',SquidCreditCard);\n\nexport { SquidCreditCard };\n"],"names":["css_248z","css","SquidCreditCard","SquidSsn","value","placeholderCharacter","firstThree","maskedValue","evt","unmaskedValue","isDelete","obfuscateValue","start","selectionStart","resolve","input","obfuscatedValue","number","nCheck","item","n","nDigit","defineSquidElement"],"mappings":"iUAIA,IAAIA,EAAWC,IASf,MAAMC,UAAwBC,CAAS,CACnC,WAAW,QAAS,CAChB,MAAO,CAAC,GAAG,MAAM,OAAOH,CAAQ,CACnC,CACD,WAAW,YAAa,CACpB,MAAO,CAAC,GAAG,MAAM,UAAU,CAC9B,CACD,aAAc,CACV,QACA,KAAK,KAAO,WACZ,KAAK,aAAe,WACvB,CAED,cAAc,CACV,MAAM,aAAY,EAClB,KAAK,aAAe,mBACpB,KAAK,UAAY,GACjB,KAAK,UAAY,GACjB,QAAQ,IAAI,KAAK,KAAK,CACzB,CAKD,SAASI,EAAM,GAAG,CACd,MAAMC,EAAuB,IAEvBC,EADgB,KAAK,QAAQF,CAAK,EACP,MAAM,EAAG,EAAE,EAAE,OAAO,GAAIC,CAAoB,EAC7E,IAAIE,EAAc,GAClB,OAAAA,GAAeD,EACf,KAAK,YAAcA,EACZC,CACV,CAKD,QAAQH,EAAM,GAAG,CACb,OAAOA,EAAM,QAAQ,MAAO,EAAE,EAAE,MAAM,EAAG,EAAE,CAC9C,CAMD,MAAM,MAAMA,EAAM,GAAII,EAAI,CAAA,EAAI,CAC1B,MAAMC,EAAgB,KAAK,QAAQL,CAAK,EAClCG,EAAc,KAAK,SAASE,CAAa,EACzCC,EAAWF,EAAI,YAAc,wBACnC,KAAK,cAAgBC,EACrB,KAAK,YAAcF,EAEnB,MAAMI,EAAiB,MAAM,KAAK,WAAWJ,CAAW,EAClDK,EAAQF,EAAY,KAAK,iBAAmBD,EAAc,OAChE,KAAK,cAAcE,EAAgBC,EAAOJ,CAAG,EAC7C,KAAK,UAAY,MACpB,CAOD,cAAcD,EAAaM,EAAgBL,EAAI,CAAA,EAAI,CAE3CA,EAAI,YAAc,0BAClBK,EAAiB,KAAK,iBAAmB,GAG7C,KAAK,WAAY,EAAC,kBAAkBA,EAAgBA,CAAc,CACrE,CAKD,WAAWT,EAAM,GAAG,CAChB,OAAO,IAAI,QAAQU,GAAW,CAC1B,MAAMC,EAAS,KAAK,aACpB,IAAIC,EAAkBZ,EAAM,MAAM,EAAG,EAAE,EAAE,QAAQ,SAAU,GAAG,EAAIA,EAAM,MAAM,GAAI,EAAE,EACpF,KAAK,iBAAmBY,EACxB,KAAK,OAAS,KAAK,cAAc,MAAM,EAAG,EAAE,EACxC,KAAK,YAAc,UACnBD,EAAM,MAAQX,EAEdW,EAAM,MAAQ,KAAK,iBAEvBD,EAAQ,KAAK,WAAW,CACpC,CAAS,CACJ,CAID,eAAgB,CAEZ,OADA,QAAQ,IAAI,KAAK,UAAU,IAAI,EAC3B,CAAC,KAAK,QAAS,KAAK,OAAO,OAAS,IAAM,CAAC,KAAK,UAAU,KAAK,MAAM,GACrE,KAAK,kBAAkB,4CAA4C,EAC5D,KAEP,KAAK,kBAAkB,EAAE,EAEtB,MAAM,gBAChB,CAMD,UAAUG,EAAO,CACb,IAAIC,EAAS,EACb,OAAAD,EAASA,EAAO,QAAQ,MAAM,EAAE,EAChCA,EAAO,MAAM,EAAE,EAAE,QAAQ,CAACE,EAAMC,IAAM,CAClC,IAAIC,EAAS,SAASF,EAAM,EAAE,EAC1B,EAAEC,EAAI,KAAOC,GAAU,GAAK,IAAGA,GAAU,GAC7CH,GAAUG,CACtB,CAAS,EACOH,EAAS,KAAQ,CAC5B,CAEL,CACAI,EAAmB,oBAAoBpB,CAAe;;;;;;;;;;"}