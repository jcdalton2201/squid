{"version":3,"file":"squid-currency.stories-4d99a8fc.js","sources":["../../dist/squid-currency/squid-currency.js"],"sourcesContent":["import { SquidInput } from '../squid-input/squid-input.js';\nimport { defineSquidElement } from '../utils/defineSquidElement.js';\n\n/**\r\n * @tag squid-currency\r\n * @summary `SquidCurrency` is an implementation of [`SquidInput`](../squid-input) with a custom mask.\r\n * Default amount is empty, not 0\r\n * Dollar sign is instantly prepended to the typed input amount upon input\r\n * Dollar sign is always displayed on the left side of the number\r\n * For amounts of less than $1, display $0.XX\r\n * Field does not pass value of dollar sign on submit\r\n * No custom number pads\r\n * Amount input must allow for input of <1.00 amounts\r\n * @prop {Boolean} dollar-only - Default value is set to false, which allows decimal value of currency. When set to true, this field does not allow decimal part of currency.\r\n * @example <squid-currency></squid-currency>\r\n */\r\nclass SquidCurrency extends SquidInput {\r\n    static get properties() {\r\n        return {\r\n            ...super.properties,\r\n            dollarOnly: { type: Boolean },\r\n        };\r\n    }\r\n    constructor() {\r\n        super();\r\n        this.bindMethod('__onInputBlur');\r\n        this.bindMethod('__validate');\r\n    }\r\n    async firstUpdated() {\r\n        this.__getInput().addEventListener('blur', this.__onInputBlur);\r\n        this.__getInput().addEventListener('change', this.__validate);\r\n        this.isCentSet = false;\r\n    }\r\n    /**\r\n     * Blur event on the input field\r\n     * @param {Event} evt blur event\r\n     */\r\n    __onInputBlur(evt) {\r\n        if (evt.currentTarget.value === '$') {\r\n            this.value = '';\r\n            this.setCustomValidity('');\r\n        } else {\r\n            if (evt.currentTarget.value.includes('.')) {\r\n                let [dollars, cents] = this.__getInput().value.split('.');\r\n                //If no input after decimal\r\n                if (cents === '') {\r\n                    cents = '00';\r\n                    this.value = this.value + '' + cents;\r\n                }\r\n                // If one number is entered after decimal\r\n                else if (cents.length === 1) {\r\n                    cents += '0';\r\n                    this.value = this.value + '0';\r\n                }\r\n                evt.target.value = dollars + '.' + cents;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Run custom validation against the input's value\r\n     */\r\n    __validate() {\r\n        const { validityMessages } = this.__getHelper();\r\n        if (this.max && +this.cleanValue > +this.max) {\r\n            this.setCustomValidity(\r\n                validityMessages.get('rangeOverflow').message\r\n            );\r\n        } else if (this.min && +this.cleanValue < +this.min) {\r\n            this.setCustomValidity(\r\n                validityMessages.get('rangeOverflow').message\r\n            );\r\n        } else {\r\n            this.setCustomValidity('');\r\n        }\r\n    }\r\n    /**\r\n     * Overwrite the input event\r\n     * @param {Event} evt input event\r\n     */\r\n    __onInput() {\r\n        const removeLeadingZeros = /^0+/;\r\n        const notNumber = this.dollarOnly ? /[^\\d]+/g : /[^\\d.]+/g;\r\n        const currencyPattern = /^(0|0?[1-9]\\d*)\\.\\d\\d\\d\\d*$/;\r\n        const threeDigitGroupings = /\\B(?=(\\d{3})+(?!\\d))/g;\r\n        const input = this.__getInput();\r\n        let maskedValue = input.value.replace(notNumber, '');\r\n        if (maskedValue[0] === '0' && maskedValue.length > 1) {\r\n            maskedValue = maskedValue.replace(removeLeadingZeros, '');\r\n        }\r\n        if (maskedValue.includes('.')) {\r\n            let [dollars, cents] = maskedValue.split('.');\r\n            //Prefix with 0 if decimal is entered in the first position\r\n            if (dollars === '') {\r\n                dollars = '0';\r\n            }\r\n            maskedValue = dollars + '.' + cents;\r\n            if (maskedValue.match(currencyPattern)) {\r\n                maskedValue = dollars + '.' + cents.substring(0, 2);\r\n            }\r\n        }\r\n        this.cleanValue = maskedValue;\r\n        maskedValue = maskedValue.replace(threeDigitGroupings, ',');\r\n        this.value = this.cleanValue;\r\n        input.value = '$' + maskedValue;\r\n        this.requestUpdate();\r\n    }\r\n    setDollorSign(){\r\n        const removeLeadingZeros = /^0+/;\r\n        const notNumber = this.dollarOnly ? /[^\\d]+/g : /[^\\d.]+/g;\r\n        const currencyPattern = /^(0|0?[1-9]\\d*)\\.\\d\\d\\d\\d*$/;\r\n        const threeDigitGroupings = /\\B(?=(\\d{3})+(?!\\d))/g;\r\n        const input = this.renderRoot.querySelector('input');\r\n        let maskedValue = input.value.replace(notNumber, '');\r\n        if (maskedValue[0] === '0' && maskedValue.length > 1) {\r\n            maskedValue = maskedValue.replace(removeLeadingZeros, '');\r\n        }\r\n        if (maskedValue.includes('.')) {\r\n            let [dollars, cents] = maskedValue.split('.');\r\n            //Prefix with 0 if decimal is entered in the first position\r\n            if (dollars === '') {\r\n                dollars = '0';\r\n            }\r\n            maskedValue = dollars + '.' + cents;\r\n            if (maskedValue.match(currencyPattern)) {\r\n                maskedValue = dollars + '.' + cents.substring(0, 2);\r\n            }\r\n        }\r\n        this.cleanValue = maskedValue;\r\n        maskedValue = maskedValue.replace(threeDigitGroupings, ',');\r\n        this.value = '$' + maskedValue;\r\n    }\r\n    updated(changedProperties){\r\n        if (changedProperties.has('value')) {\r\n            this.setDollorSign();\r\n        }\r\n    }\r\n}\r\ndefineSquidElement('squid-currency', SquidCurrency);\n\nexport { SquidCurrency };\n"],"names":["SquidCurrency","SquidInput","evt","dollars","cents","validityMessages","removeLeadingZeros","notNumber","currencyPattern","threeDigitGroupings","input","maskedValue","changedProperties","defineSquidElement"],"mappings":"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"}